

#!/bin/bash

# prints data on number of threads and number of trials

print_header=1
mkdir -p data
rm data/pmcs_opt_n.csv

for t in 1 2 4 8 16 32 64
do
    for n in 64 128 256
    do
        gcc -O3 -lm -fopenmp -DPRINT_HEADER=$print_header -DUSE_RAND_R \
            -DNUM_TRIALS=$n -DNUM_THREADS=$t \
            pmcs_analytics.c game.c pmcs.c utilities.c -o ./bin/pmcs_analytics

        ./bin/pmcs_analytics >> ./data/pmcs_opt_n.csv 2>&1

        # Turn off headers after one iteration
        if [ $print_header == 1 ]; then
            print_header=0
        fi
    done
done